#include <random>
#include <iostream>
#include "../lib/madstore.h"
#include "../lib/print.h"

using namespace std;

int main(int argc, char** arv) {
  typedef Store<3,unsigned long,2> Store1;

  vector<string> countries {"AD", "AE", "AF", "AG", "AI", "AL", "AM", "AO", "AQ", "AR", "AS", "AT", "AU", "AW", "AX", "AZ", "BA", "BB", "BD", "BE", "BF", "BG", "BH", "BI", "BJ", "BL", "BM", "BN", "BO", "BQ", "BQ", "BR", "BS", "BT", "BV", "BW", "BY", "BZ", "CA", "CC", "CD", "CF", "CG", "CH", "CI", "CK", "CL", "CM", "CN", "CO", "CR", "CU", "CV", "CW", "CX", "CY", "CZ", "DE", "DJ", "DK", "DM", "DO", "DZ", "EC", "EE", "EG", "EH", "ER", "ES", "ET", "FI", "FJ", "FK", "FM", "FO", "FR", "GA", "GB", "GD", "GE", "GF", "GG", "GH", "GI", "GL", "GM", "GN", "GP", "GQ", "GR", "GS", "GT", "GU", "GW", "GY", "HK", "HM", "HN", "HR", "HT", "HU", "ID", "IE", "IL", "IM", "IN", "IO", "IQ", "IR", "IS", "IT", "JE", "JM", "JO", "JP", "KE", "KG", "KH", "KI", "KM", "KN", "KP", "KR", "KW", "KY", "KZ", "LA", "LB", "LC", "LI", "LK", "LR", "LS", "LT", "LU", "LV", "LY", "MA", "MC", "MD", "ME", "MF", "MG", "MH", "MK", "ML", "MM", "MN", "MO", "MP", "MQ", "MR", "MS", "MT", "MU", "MV", "MW", "MX", "MY", "MZ", "NA", "NC", "NE", "NF", "NG", "NI", "NL", "NO", "NP", "NR", "NU", "NZ", "OM", "PA", "PE", "PF", "PG", "PH", "PK", "PL", "PM", "PN", "PR", "PS", "PT", "PW", "PY", "QA", "RE", "RO", "RS", "RU", "RW", "SA", "SB", "SC", "SD", "SE", "SG", "SH", "SI", "SJ", "SK", "SL", "SM", "SN", "SO", "SR", "SS", "ST", "SV", "SX", "SY", "SZ", "TC", "TD", "TF", "TG", "TH", "TJ", "TK", "TL", "TM", "TN", "TO", "TR", "TT", "TV", "TW", "TZ", "UA", "UG", "UM", "US", "UY", "UZ", "VA", "VC", "VE", "VG", "VI", "VN", "VU", "WF", "WS", "YE", "YT", "ZA", "ZM", "ZW"};

  vector<string> hours {"2015040915", "2015040916", "2015040917", "2015040918", "2015040919", "2015040920", "2015040921", "2015040922", "2015040923", "2015041000", "2015041001", "2015041002", "2015041003", "2015041004", "2015041005", "2015041006", "2015041007", "2015041008", "2015041009", "2015041010", "2015041011", "2015041012", "2015041013", "2015041014", "2015041015", "2015041016", "2015041017", "2015041018", "2015041019", "2015041020", "2015041021", "2015041022", "2015041023", "2015041100", "2015041101", "2015041102", "2015041103", "2015041104", "2015041105", "2015041106", "2015041107", "2015041108", "2015041109", "2015041110", "2015041111", "2015041112", "2015041113", "2015041114", "2015041115", "2015041116", "2015041117", "2015041118", "2015041119", "2015041120", "2015041121", "2015041122", "2015041123", "2015041200", "2015041201", "2015041202", "2015041203", "2015041204", "2015041205", "2015041206", "2015041207", "2015041208", "2015041209", "2015041210", "2015041211", "2015041212", "2015041213", "2015041214", "2015041215", "2015041216", "2015041217", "2015041218", "2015041219", "2015041220", "2015041221", "2015041222", "2015041223", "2015041300", "2015041301", "2015041302", "2015041303", "2015041304", "2015041305", "2015041306", "2015041307", "2015041308", "2015041309", "2015041310", "2015041311", "2015041312", "2015041313", "2015041314", "2015041315", "2015041316", "2015041317", "2015041318", "2015041319", "2015041320", "2015041321", "2015041322", "2015041323", "2015041400", "2015041401", "2015041402", "2015041403", "2015041404", "2015041405", "2015041406", "2015041407", "2015041408", "2015041409", "2015041410", "2015041411", "2015041412", "2015041413", "2015041414", "2015041415", "2015041416", "2015041417", "2015041418", "2015041419", "2015041420", "2015041421", "2015041422", "2015041423", "2015041500", "2015041501", "2015041502", "2015041503", "2015041504", "2015041505", "2015041506", "2015041507", "2015041508", "2015041509", "2015041510", "2015041511", "2015041512", "2015041513", "2015041514", "2015041515", "2015041516", "2015041517", "2015041518", "2015041519", "2015041520", "2015041521", "2015041522", "2015041523", "2015041600", "2015041601", "2015041602", "2015041603", "2015041604", "2015041605", "2015041606", "2015041607", "2015041608", "2015041609", "2015041610", "2015041611", "2015041612", "2015041613", "2015041614", "2015041615", "2015041616", "2015041617", "2015041618", "2015041619", "2015041620", "2015041621", "2015041622", "2015041623", "2015041700", "2015041701", "2015041702", "2015041703", "2015041704", "2015041705", "2015041706", "2015041707", "2015041708", "2015041709", "2015041710", "2015041711", "2015041712", "2015041713", "2015041714", "2015041715", "2015041716", "2015041717", "2015041718", "2015041719", "2015041720", "2015041721", "2015041722", "2015041723", "2015041800", "2015041801", "2015041802", "2015041803", "2015041804", "2015041805", "2015041806", "2015041807", "2015041808", "2015041809", "2015041810", "2015041811", "2015041812", "2015041813", "2015041814", "2015041815", "2015041816", "2015041817", "2015041818", "2015041819", "2015041820", "2015041821", "2015041822", "2015041823", "2015041900", "2015041901", "2015041902", "2015041903", "2015041904", "2015041905", "2015041906", "2015041907", "2015041908", "2015041909", "2015041910", "2015041911", "2015041912", "2015041913", "2015041914", "2015041915", "2015041916", "2015041917", "2015041918", "2015041919", "2015041920", "2015041921", "2015041922", "2015041923", "2015042000", "2015042001", "2015042002", "2015042003", "2015042004", "2015042005", "2015042006", "2015042007", "2015042008", "2015042009", "2015042010", "2015042011", "2015042012", "2015042013", "2015042014", "2015042015", "2015042016", "2015042017", "2015042018", "2015042019", "2015042020", "2015042021", "2015042022", "2015042023", "2015042100", "2015042101", "2015042102", "2015042103", "2015042104", "2015042105", "2015042106", "2015042107", "2015042108", "2015042109", "2015042110", "2015042111", "2015042112", "2015042113", "2015042114", "2015042115", "2015042116", "2015042117", "2015042118", "2015042119", "2015042120", "2015042121", "2015042122", "2015042123", "2015042200", "2015042201", "2015042202", "2015042203", "2015042204", "2015042205", "2015042206", "2015042207", "2015042208", "2015042209", "2015042210", "2015042211", "2015042212", "2015042213", "2015042214", "2015042215", "2015042216", "2015042217", "2015042218", "2015042219", "2015042220", "2015042221", "2015042222", "2015042223", "2015042300", "2015042301", "2015042302", "2015042303", "2015042304", "2015042305", "2015042306", "2015042307", "2015042308", "2015042309", "2015042310", "2015042311"};

  vector<string> apps {"com.comuto", "com.qihoo.security"};

  Store1::Metrics metrics;
  metrics[0] = 1;
  metrics[1] = 1;

  mt19937 rng;
  rng.seed(random_device()());
  uniform_int_distribution<mt19937::result_type> rand_countries(0, countries.size()-1);
  uniform_int_distribution<mt19937::result_type> rand_hours(0, hours.size()-1);
  uniform_int_distribution<mt19937::result_type> rand_apps(0, apps.size()-1);

  Store1 store1;
  for (int i = 0; i < 1000000000; ++i) {
    Store1::Dims dims;

    dims[0] = countries[rand_countries(rng)];
    dims[1] = hours[rand_hours(rng)];
    dims[2] = apps[rand_apps(rng)];

    store1.upsert(dims, metrics);
  }

  /*
  for(Store1::Record_Map::const_iterator it = store1.records.begin(); it != store1.records.end(); ++it) {
    cout<<it->first<<it->second<<endl;
  }
  */
}
